---
title: "NBA Fantasy Team Projections"
author: "Brandon L. Kramer"
output: html_document
---

## Data Preparation 

First, I am pulling data collected from www.basketball-reference.com for the 2018 NBA season that provides a basis for how players performed last year. I am also pulling performance projections from hashtagbasketball.com and a database that one of my fantasy friends shared with me as well. I then bind these data sources together, renaming the various columns in order to distinguish them for models and rankings later on. 

```{r pull packages and projection data}
#install.packages("tidyverse"); install.packages("googlesheets"); install.packages("teamcolors")
rm(list = ls())
for (pkg in c("googlesheets", "tidyverse", "teamcolors")) {library(pkg, character.only = TRUE)}
(my_sheets <- gs_ls())

bballref18 <- gs_url("https://docs.google.com/spreadsheets/d/13EnBmUWDmxJ86xFzCpaHUuXGW0KADW_bDUVLf0dWFgA/edit#gid=58340951") %>% 
  gs_read(ws = "bballref18") 

bballref18$player <- bballref18$player %>% 
  str_replace_all(c('Á' = 'A', 'ā' = 'a', 'á' = 'a', 'č' = 'c', 'ć' = 'c', 'è' = 'e', 'é' = 'e', 'ê' = 'e', 'ić' = 'ic',
                    'ö' = 'o', 'ó' = 'o', 'Š' = 'S', 'š' = 's', 'ū' = 'u', 'ý' = 'y', 'Ž' = 'Z', 'ž' = 'z', 'Élie' = 'Elie',
                    'P.J.' = 'PJ','C.J.' = 'CJ', 'R.J.' = 'RJ', 'T.J.' = 'TJ', 'D.J.' = 'DJ', 'J.J.' = 'JJ', 'Dončić' = 'Doncic',
                    'Louis' = 'Lou', 'Edrice' = 'Bam', 'Waller-Prince' = 'Prince', "O.G." = "OG", "Demarre" = "DeMarre",
                    'Jaren Jackson' = 'Jaren Jackson Jr.','Kelly Oubre' = 'Kelly Oubre Jr.', 
                    'Marvin Bagley' = 'Marvin Bagley III', 'Otto Porter' = 'Otto Porter Jr.', 
                    'Wendell Carter' = 'Wendell Carter Jr.', 'Larry Nance' = 'Larry Nance Jr.',
                    'Walt Lemon' = 'Walt Lemon Jr.', 'Dennis Schröder' = 'Dennis Schroder', 
                    'Tim Hardaway' = 'Tim Hardaway Jr.'))

combined_data <- bballref18 %>% 
  rename(bbr_pts = "PTS", bbr_dreb = "DRB", bbr_orb = "ORB",
         bbr_ast = "AST", bbr_stl = "STL", bbr_blk = "BLK",
         bbr_tov = "TOV", bbr_threes = "3P", bbr_fga = "FGA",
         bbr_fgm = "FG", bbr_ftm = "FT",  bbr_fta = "FTA", bbr_gms = "G", bbr_mpg = "MP", age = "Age") %>%
  mutate(bbr_ld_fpts = bbr_pts + (bbr_dreb*1.5) + (bbr_orb*2) + (bbr_ast*2) + (bbr_stl*2.5) + (bbr_blk*2.5) +
         (bbr_tov*-1) + bbr_threes + (bbr_fga*-0.5) + (bbr_fgm*0.5) + bbr_ftm + (bbr_fta*-1)) %>%
  mutate(bbr_fr_fpts = bbr_pts + (bbr_dreb*1.5) + (bbr_orb*2) + (bbr_ast*2) + (bbr_stl*2.5) + (bbr_blk*2.5) +
         (bbr_tov*-1) + bbr_threes + (bbr_fga*-0.5) + (bbr_fgm*0.5) + bbr_ftm + (bbr_fta*-1)) %>% 
  mutate(bbr_gsd2_fpts = bbr_pts + bbr_dreb + (bbr_orb*1.25) + (bbr_ast*1.5) + (bbr_stl*1.5) + (bbr_blk*2) +
         (bbr_tov*-1)+bbr_threes+(bbr_fga*-0.5)+(bbr_fgm*0.5)+(bbr_ftm*0.5)+(bbr_fta*-0.75)) %>%
  mutate(bbr_botb_fpts = bbr_pts + bbr_dreb + (bbr_orb*1.25) + (bbr_ast*1.5) + (bbr_stl*1.5) + (bbr_blk*2) +
         (bbr_tov*-1)+bbr_threes+(bbr_fga*-0.5)+(bbr_fgm*0.5)+(bbr_ftm*0.5)+(bbr_fta*-0.75)) %>% 
  select(player, age, bbr_ld_fpts, bbr_fr_fpts, bbr_gsd2_fpts, bbr_botb_fpts, bbr_gms, bbr_mpg,
         bbr_pts, bbr_dreb, bbr_orb, bbr_ast, bbr_stl, bbr_blk, bbr_tov, bbr_threes, bbr_fga, bbr_fgm, bbr_ftm, bbr_fta)

hashalt19 <- gs_url("https://docs.google.com/spreadsheets/d/13EnBmUWDmxJ86xFzCpaHUuXGW0KADW_bDUVLf0dWFgA/edit#gid=2083425618") %>% gs_read(ws = "2019_hashtag_alt_proj") 

hashalt19$player <- hashalt19$player %>% 
  str_replace_all(c('Á' = 'A', 'ā' = 'a', 'á' = 'a', 'č' = 'c', 'ć' = 'c', 'è' = 'e', 'é' = 'e', 'ê' = 'e',
                    'ö' = 'o', 'ó' = 'o', 'Š' = 'S', 'š' = 's', 'ū' = 'u', 'ý' = 'y', 'Ž' = 'Z', 'ž' = 'z',
                    'P.J.' = 'PJ','C.J.' = 'CJ', 'R.J.' = 'RJ', 'T.J.' = 'TJ', 'D.J.' = 'DJ', 'J.J.' = 'JJ',
                    'Louis' = 'Lou', 'Edrice' = 'Bam', 'Waller-Prince' = 'Prince', "O.G." = "OG", "Demarre" = "DeMarre",
                    'Jaren Jackson' = 'Jaren Jackson Jr.','Kelly Oubre' = 'Kelly Oubre Jr.', 
                    'Marvin Bagley' = 'Marvin Bagley III', 'Otto Porter' = 'Otto Porter Jr.', 
                    'Wendell Carter' = 'Wendell Carter Jr.', 'Larry Nance' = 'Larry Nance Jr.',
                    'Walt Lemon' = 'Walt Lemon Jr.', 'Dennis Schröder' = 'Dennis Schroder', 
                    'Tim Hardaway' = 'Tim Hardaway Jr.'))

hashalt19 <- hashalt19 %>% 
  rename(hta_pts = "PTS", hta_treb = "REB", hta_ast = "AST", hta_stl = "STL", hta_blk = "BLK",
         hta_tov = "TOV", hta_threes = "THREES", hta_fga = "FGA",hta_fgm = "FGM", hta_ftm = "FTM",  
         hta_fta = "FTA", hta_mpg = "MPG", hta_ftp = "FT", hta_gms = "Gs") %>%
  mutate(hta_dreb = hta_treb*0.78) %>% 
  mutate(hta_orb = hta_treb*0.22) %>% 
  mutate(hta_ld_fpts = hta_pts + (hta_dreb*1.5) + (hta_orb*2) + (hta_ast*2) + (hta_stl*2.5) + (hta_blk*2.5) +
         (hta_tov*-1) + hta_threes + (hta_fga*-0.5) + (hta_fgm*0.5) + hta_ftm + (hta_fta*-1)) %>%
  mutate(hta_fr_fpts = hta_pts + (hta_dreb*1.5) + (hta_orb*2) + (hta_ast*2) + (hta_stl*2.5) + (hta_blk*2.5) +
         (hta_tov*-1) + hta_threes + (hta_fga*-0.5) + (hta_fgm*0.5) + hta_ftm + (hta_fta*-1)) %>% 
  mutate(hta_gsd2_fpts = hta_pts + hta_dreb + (hta_orb*1.25) + (hta_ast*1.5) + (hta_stl*1.5) + (hta_blk*2) +
         (hta_tov*-1)+hta_threes+(hta_fga*-0.5)+(hta_fgm*0.5)+(hta_ftm*0.5)+(hta_fta*-0.75)) %>%
  mutate(hta_botb_fpts = hta_pts + hta_dreb + (hta_orb*1.25) + (hta_ast*1.5) + (hta_stl*1.5) + (hta_blk*2) +
         (hta_tov*-1)+hta_threes+(hta_fga*-0.5)+(hta_fgm*0.5)+(hta_ftm*0.5)+(hta_fta*-0.75)) %>% 
  select(player, hta_ld_fpts, hta_fr_fpts, hta_gsd2_fpts, hta_botb_fpts, hta_gms, hta_mpg, 
         hta_pts, hta_dreb, hta_orb, hta_ast, hta_stl, hta_blk, hta_tov, hta_threes, hta_fga, hta_fgm, hta_ftm, hta_fta, hta_ftp)
  
combined_data <- combined_data %>% 
  full_join(hashalt19, by = "player")

hashtag19 <- gs_url("https://docs.google.com/spreadsheets/d/13EnBmUWDmxJ86xFzCpaHUuXGW0KADW_bDUVLf0dWFgA/edit#gid=665288709") %>% gs_read(ws = "2019_hashtag_proj") 

hashtag19$player <- hashtag19$player %>% 
  str_replace_all(c('Á' = 'A', 'ā' = 'a', 'á' = 'a', 'č' = 'c', 'ć' = 'c', 'è' = 'e', 'é' = 'e', 'ê' = 'e',
                    'ö' = 'o', 'ó' = 'o', 'Š' = 'S', 'š' = 's', 'ū' = 'u', 'ý' = 'y', 'Ž' = 'Z', 'ž' = 'z',
                    'P.J.' = 'PJ','C.J.' = 'CJ', 'R.J.' = 'RJ', 'T.J.' = 'TJ', 'D.J.' = 'DJ', 'J.J.' = 'JJ',
                    'Louis' = 'Lou', 'Edrice' = 'Bam', 'Waller-Prince' = 'Prince', "O.G." = "OG", "Demarre" = "DeMarre",
                    'Dennis Schröder' = 'Dennis Schroder'))

hashtag19 <- hashtag19 %>% 
  rename(ht_pts = "PTS", ht_dreb = "DREB", ht_orb = "OREB", ht_ast = "AST", ht_stl = "STL", ht_blk = "BLK",
         ht_tov = "TO", ht_threes = "THREES", ht_fga = "FGA", ht_fgm = "FGM", ht_ftm = "FTM",  
         ht_fta = "FTA", ht_mpg = "MPG", ht_gms = "GP", ht_fgp = "FG%", ht_ftp = "FT%") %>%
  mutate(ht_ld_fpts = ht_pts + (ht_dreb*1.5) + (ht_orb*2) + (ht_ast*2) + (ht_stl*2.5) + (ht_blk*2.5) +
         (ht_tov*-1) + ht_threes + (ht_fga*-0.5) + (ht_fgm*0.5) + ht_ftm + (ht_fta*-1)) %>%
  mutate(ht_fr_fpts = ht_pts + (ht_dreb*1.5) + (ht_orb*2) + (ht_ast*2) + (ht_stl*2.5) + (ht_blk*2.5) +
         (ht_tov*-1) + ht_threes + (ht_fga*-0.5) + (ht_fgm*0.5) + ht_ftm + (ht_fta*-1)) %>% 
  mutate(ht_gsd2_fpts = ht_pts + ht_dreb + (ht_orb*1.25) + (ht_ast*1.5) + (ht_stl*1.5) + (ht_blk*2) +
         (ht_tov*-1)+ht_threes+(ht_fga*-0.5)+(ht_fgm*0.5)+(ht_ftm*0.5)+(ht_fta*-0.75)) %>%
  mutate(ht_botb_fpts = ht_pts + ht_dreb + (ht_orb*1.25) + (ht_ast*1.5) + (ht_stl*1.5) + (ht_blk*2) +
         (ht_tov*-1)+ht_threes+(ht_fga*-0.5)+(ht_fgm*0.5)+(ht_ftm*0.5)+(ht_fta*-0.75)) %>% 
  select(player, ht_ld_fpts, ht_fr_fpts, ht_gsd2_fpts, ht_botb_fpts, ht_gms, ht_mpg, 
         ht_pts, ht_dreb, ht_orb, ht_ast, ht_stl, ht_blk, ht_tov, ht_threes, ht_fga, ht_fgm, ht_fgp, ht_ftm, ht_fta, ht_ftp)

combined_data <- combined_data %>% 
  full_join(hashtag19, by = "player")
```

```{r contract data}
# contract data 

spottrac_contracts <- gs_url("https://docs.google.com/spreadsheets/d/13EnBmUWDmxJ86xFzCpaHUuXGW0KADW_bDUVLf0dWFgA/edit#gid=2095258080") %>% gs_read(ws = "botb_contracts") 
spottrac_contracts$player <- spottrac_contracts$player %>% 
  str_replace_all(c('C.J.' = 'CJ', 'R.J.' = 'RJ', 'T.J.' = 'TJ', 'D.J.' = 'DJ', "O.G." = "OG", "Demarre" = "DeMarre",
                    'Louis' = 'Lou', 'Edrice' = 'Bam', 'Waller-Prince' = 'Prince', 
                    'Á' = 'A', 'ā' = 'a', 'á' = 'a', 'č' = 'c', 'ć' = 'c', 'è' = 'e', 'é' = 'e', 'ê' = 'e',
                    'ö' = 'o', 'ó' = 'o', 'Š' = 'S', 'š' = 's', 'ū' = 'u', 'ý' = 'y', 'Ž' = 'Z', 'ž' = 'z',
                    'P.J.' = 'PJ','C.J.' = 'CJ', 'R.J.' = 'RJ', 'T.J' = 'TJ', 'D.J.' = 'DJ', 'J.J.' = 'JJ'))

combined_data <- combined_data %>% 
  full_join(spottrac_contracts, by = "player")

legacy_contracts <- gs_url("https://docs.google.com/spreadsheets/d/13EnBmUWDmxJ86xFzCpaHUuXGW0KADW_bDUVLf0dWFgA/edit#gid=0") %>% gs_read(ws = "legacy_contracts") 

legacy_contracts$player <- legacy_contracts$player %>% 
  str_replace_all(c('C.J.' = 'CJ', 'R.J.' = 'RJ', 'T.J.' = 'TJ', 'D.J.' = 'DJ', "O.G." = "OG", "Demarre" = "DeMarre",
                    'Louis' = 'Lou', 'Edrice' = 'Bam', 'Waller-Prince' = 'Prince', 
                    'Á' = 'A', 'ā' = 'a', 'á' = 'a', 'č' = 'c', 'ć' = 'c', 'è' = 'e', 'é' = 'e', 'ê' = 'e',
                    'ö' = 'o', 'ó' = 'o', 'Š' = 'S', 'š' = 's', 'ū' = 'u', 'ý' = 'y', 'Ž' = 'Z', 'ž' = 'z',
                    'P.J.' = 'PJ','C.J.' = 'CJ', 'R.J.' = 'RJ', 'T.J' = 'TJ', 'D.J.' = 'DJ', 'J.J.' = 'JJ'))

combined_data <- combined_data %>% 
  full_join(legacy_contracts, by = "player")

franchise_contracts <- gs_url("https://docs.google.com/spreadsheets/d/13EnBmUWDmxJ86xFzCpaHUuXGW0KADW_bDUVLf0dWFgA/edit#gid=1961950332") %>% gs_read(ws = "franchise_contracts") 

franchise_contracts$player <- franchise_contracts$player %>% 
  str_replace_all(c('C.J.' = 'CJ', 'R.J.' = 'RJ', 'T.J.' = 'TJ', 'D.J.' = 'DJ', "O.G." = "OG", "Demarre" = "DeMarre",
                    'Louis' = 'Lou', 'Edrice' = 'Bam', 'Waller-Prince' = 'Prince', 
                    'Á' = 'A', 'ā' = 'a', 'á' = 'a', 'č' = 'c', 'ć' = 'c', 'è' = 'e', 'é' = 'e', 'ê' = 'e',
                    'ö' = 'o', 'ó' = 'o', 'Š' = 'S', 'š' = 's', 'ū' = 'u', 'ý' = 'y', 'Ž' = 'Z', 'ž' = 'z',
                    'P.J.' = 'PJ','C.J.' = 'CJ', 'R.J.' = 'RJ', 'T.J' = 'TJ', 'D.J.' = 'DJ', 'J.J.' = 'JJ'))

combined_data <- combined_data %>% 
  full_join(franchise_contracts, by = "player") 

the_invitational <- gs_url("https://docs.google.com/spreadsheets/d/13EnBmUWDmxJ86xFzCpaHUuXGW0KADW_bDUVLf0dWFgA/edit#gid=1960421065") %>% gs_read(ws = "the_invitational")

the_invitational$player <- the_invitational$player %>% 
  str_replace_all(c('C.J.' = 'CJ', 'R.J.' = 'RJ', 'T.J.' = 'TJ', 'D.J.' = 'DJ', "O.G." = "OG", "Demarre" = "DeMarre",
                    'Louis' = 'Lou', 'Edrice' = 'Bam', 'Waller-Prince' = 'Prince', 
                    'Á' = 'A', 'ā' = 'a', 'á' = 'a', 'č' = 'c', 'ć' = 'c', 'è' = 'e', 'é' = 'e', 'ê' = 'e',
                    'ö' = 'o', 'ó' = 'o', 'Š' = 'S', 'š' = 's', 'ū' = 'u', 'ý' = 'y', 'Ž' = 'Z', 'ž' = 'z',
                    'P.J.' = 'PJ','C.J.' = 'CJ', 'R.J.' = 'RJ', 'T.J' = 'TJ', 'D.J.' = 'DJ', 'J.J.' = 'JJ'))

combined_data <- combined_data %>% 
  full_join(the_invitational, by = "player")

```

```{r adding in schedule}
nba_schedule <- gs_url("https://docs.google.com/spreadsheets/d/13EnBmUWDmxJ86xFzCpaHUuXGW0KADW_bDUVLf0dWFgA/edit#gid=1604050216") %>% gs_read(ws = "2019_nba_schedule")

combined_data <- combined_data %>% 
  full_join(nba_schedule, by = "nba_team"); rm(nba_schedule)
```


```{r select_data}
select_data <- combined_data %>% 
  select(player, age,
         bbr_ld_fpts, bbr_fr_fpts, bbr_gsd2_fpts, bbr_botb_fpts, bbr_gms, bbr_mpg,
         hta_ld_fpts, hta_fr_fpts, hta_gsd2_fpts, hta_botb_fpts, hta_gms, hta_mpg,
         ht_ld_fpts, ht_fr_fpts, ht_gsd2_fpts, ht_botb_fpts, ht_gms, ht_mpg, inv_abbreviated,
         botb_team, spottrac_2019,	spottrac_2020, spottrac_2021, spottrac_2022, spottrac_2023, spottrac_rfa, 
         ld_team, ld_2019, ld_2020, ld_2021, ld_2022, ld_2023, ld_2024, ld_rfa, ld_gleague, ld_intl,
         fr_team, fr_2019, fr_2020, fr_2021, fr_2022, fr_2023, fr_2024, fr_rfa, fr_gleague, fr_intl, week1:week26)
rm(bballref18, hashtag19, hashalt19, legacy_contracts, franchise_contracts, the_invitational, spottrac_contracts, my_sheets)
```

# Team Projections 

## Legacy Dynasty

```{r ld 2018 bbr projections, fig.width=11, fig.height=6}
ld_temp_1 <- select_data %>% 
  filter(ld_gleague == "0" | ld_intl == "0") %>% 
  group_by(ld_team) %>% summarize(avg_fppg = mean(bbr_ld_fpts, na.rm = TRUE))  
ld_temp_2 <- select_data %>% 
  filter(ld_gleague == "0" | ld_intl == "0") %>% 
  group_by(ld_team) %>% summarize(ld_players = n())
ld_temp_3 <- select_data %>% 
  filter(ld_gleague == "0" | ld_intl == "0") %>%
  group_by(ld_team) %>% 
  summarize(ld_2019_cap = sum(ld_2019, na.rm = TRUE))
ld_temp_4 <- select_data %>% 
  filter(ld_gleague == "1" | ld_intl == "1") %>%
  group_by(ld_team) %>%
  summarize(gleague_cap = sum(ld_2019 / 2, na.rm = TRUE)) 

# need to fix this snippit still 

ld_bbr_team_projections <- full_join(ld_temp_1, ld_temp_2, by = "ld_team") %>% 
  full_join(ld_temp_2, ld_temp_3, by = "ld_team") %>% 
  full_join(ld_temp_3, ld_temp_4, by = "ld_team") #%>%
  mutate(team_total = avg_fppg * ld_players) #%>% 
  
mutate(ld_2019_cap = ld_2019_cap + gleague_cap) %>% 
  arrange(-team_total); rm(ld_temp_1, ld_temp_2)
ld_bbr_team_projections
ggplot(data=ld_bbr_team_projections, aes(x=reorder(ld_team, -team_total), y=team_total, fill=ld_team)) +
  geom_bar(stat="identity", width=0.6, colour="black") +
  theme_bw() +
  theme(axis.title.x=element_blank(), axis.title.y=element_blank()) +
  labs(title = "Legacy Dynasty Rankings (Based on 2018 Stats)", fill = "LD Team Name") +
  scale_fill_manual(values=c("#C8102E", "#061922", "#008348", "#00788C", "#ce1141", "#860038", "#007dc5", "#0E2240", "#C8102E", "#1D428A",
                             "#ce1141", "#ffc633", "#1D428A", "#552582", "#5D76A9", "#98002e", "#00471b", "#78be20", "#b6995a", "#F58426",
                             "#EF3B24", "#007dc5", "#006bb6", "#e56020", "#000000", "#724c9f", "#bac3c9", "#ce1141", "#002B5C", "#002b5c")) 
```

```{r ld 2019 hta projections, fig.width=11, fig.height=6}
ld_temp_1 <- select_data %>% 
  filter(ld_gleague == "0" | ld_intl == "0") %>%
  group_by(ld_team) %>% summarize(avg_fppg = mean(hta_ld_fpts, na.rm = TRUE))  
ld_temp_2 <- select_data %>% 
  filter(ld_gleague == "0" | ld_intl == "0") %>%
  group_by(ld_team) %>% summarize(ld_players = n())
ld_hta_team_projections <- full_join(ld_temp_1, ld_temp_2, by = "ld_team") %>% 
  mutate(team_total = avg_fppg * ld_players) %>% 
  arrange(-team_total); rm(ld_temp_1, ld_temp_2)
ld_hta_team_projections
ggplot(data=ld_hta_team_projections, aes(x=reorder(ld_team, -team_total), y=team_total, fill=ld_team)) +
  geom_bar(stat="identity", width=0.6, colour="black") +
  theme_bw() +
  theme(axis.title.x=element_blank(), axis.title.y=element_blank()) +
  labs(title = "Legacy Dynasty Rankings (Based on 2019 Hashtag Alternative Projections)", fill = "LD Team Name") +
  scale_fill_manual(values=c("#C8102E", "#061922", "#008348", "#00788C", "#ce1141", "#860038", "#007dc5", "#0E2240", "#C8102E", "#1D428A",
                             "#ce1141", "#ffc633", "#1D428A", "#552582", "#5D76A9", "#98002e", "#00471b", "#78be20", "#b6995a", "#F58426",
                             "#EF3B24", "#007dc5", "#006bb6", "#e56020", "#000000", "#724c9f", "#bac3c9", "#ce1141", "#002B5C", "#002b5c")) 
```

```{r ld 2019 ht projections, fig.width=11, fig.height=6}
ld_temp_1 <- select_data %>% 
  filter(ld_gleague == "0" | ld_intl == "0") %>%  
  group_by(ld_team) %>% summarize(avg_fppg = mean(ht_ld_fpts, na.rm = TRUE))  
ld_temp_2 <- select_data %>% 
  filter(ld_gleague == "0" | ld_intl == "0") %>%
  group_by(ld_team) %>% summarize(ld_players = n())
ld_ht_team_projections <- full_join(ld_temp_1, ld_temp_2, by = "ld_team") %>% 
  mutate(team_total = avg_fppg * ld_players) %>% 
  arrange(-team_total); rm(ld_temp_1, ld_temp_2)
ld_ht_team_projections
ggplot(data=ld_ht_team_projections, aes(x=reorder(ld_team, -team_total), y=team_total, fill=ld_team)) +
  geom_bar(stat="identity", width=0.6, colour="black") +
  theme_bw() +
  theme(axis.title.x=element_blank(), axis.title.y=element_blank()) +
  labs(title = "Legacy Dynasty Rankings (Based on 2019 Hashtag Projections)", fill = "LD Team Name") +
  scale_fill_manual(values=c("#C8102E", "#061922", "#008348", "#00788C", "#ce1141", "#860038", "#007dc5", "#0E2240", "#C8102E", "#1D428A",
                             "#ce1141", "#ffc633", "#1D428A", "#552582", "#5D76A9", "#98002e", "#00471b", "#78be20", "#b6995a", "#F58426",
                             "#EF3B24", "#007dc5", "#006bb6", "#e56020", "#000000", "#724c9f", "#bac3c9", "#ce1141", "#002B5C", "#002b5c")) 
```

```{r looking at specific team's players projections}
select_data %>% 
  filter(ld_team == "MIN") %>% 
  select(player, age, ld_team, bbr_ld_fpts, hta_ld_fpts, ht_ld_fpts, 
         ld_2019, ld_2020, ld_2021, ld_2022, ld_2023, ld_2024, ld_rfa, ld_gleague, ld_intl)
```

## Franchise NBA 

```{r fr 2018 bbr projections, fig.width=11, fig.height=6}
fr_temp_1 <- select_data %>% 
  filter(ld_gleague == "0" | ld_intl == "0") %>% 
  group_by(fr_team) %>% summarize(avg_fppg = mean(bbr_fr_fpts, na.rm = TRUE))  
fr_temp_2 <- select_data %>% 
  filter(ld_gleague == "0" | ld_intl == "0") %>% 
  group_by(fr_team) %>% summarize(fr_players = n())
fr_bbr_team_projections <- full_join(fr_temp_1, fr_temp_2, by = "fr_team") %>% 
  mutate(team_total = avg_fppg * fr_players) %>% 
  arrange(-team_total); rm(fr_temp_1, fr_temp_2)
fr_bbr_team_projections
ggplot(data=fr_bbr_team_projections, aes(x=reorder(fr_team, -team_total), y=team_total, fill=fr_team)) +
  geom_bar(stat="identity", width=0.6, colour="black") +
  theme_bw() +
  theme(axis.title.x=element_blank(), axis.title.y=element_blank()) +
  labs(title = "Franchise NBA Rankings (Based on 2018 Stats)", fill = "Franchise Team") +
  scale_fill_manual(values=c("#C8102E", "#061922", "#008348", "#00788C", "#ce1141", "#860038", "#007dc5", "#0E2240", "#C8102E", "#1D428A",
                             "#ce1141", "#ffc633", "#1D428A", "#552582", "#5D76A9", "#98002e", "#00471b", "#78be20", "#b6995a", "#F58426",
                             "#EF3B24", "#007dc5", "#006bb6", "#e56020", "#000000", "#724c9f", "#bac3c9", "#ce1141", "#002B5C", "#002b5c")) 
```

```{r fr 2019 hta projections, fig.width=11, fig.height=6}
fr_temp_1 <- select_data %>% 
  filter(ld_gleague == "0" | ld_intl == "0") %>%
  group_by(fr_team) %>% summarize(avg_fppg = mean(hta_fr_fpts, na.rm = TRUE))  
fr_temp_2 <- select_data %>% 
  filter(ld_gleague == "0" | ld_intl == "0") %>%
  group_by(fr_team) %>% summarize(fr_players = n())
fr_hta_team_projections <- full_join(fr_temp_1, fr_temp_2, by = "fr_team") %>% 
  mutate(team_total = avg_fppg * fr_players) %>% 
  arrange(-team_total); rm(fr_temp_1, fr_temp_2)
fr_hta_team_projections
ggplot(data=fr_hta_team_projections, aes(x=reorder(fr_team, -team_total), y=team_total, fill=fr_team)) +
  geom_bar(stat="identity", width=0.6, colour="black") +
  theme_bw() +
  theme(axis.title.x=element_blank(), axis.title.y=element_blank()) +
  labs(title = "Franchise NBA Rankings (Based on 2019 Hashtag Alternative Projections)", fill = "Franchise Team") +
  scale_fill_manual(values=c("#C8102E", "#061922", "#008348", "#00788C", "#ce1141", "#860038", "#007dc5", "#0E2240", "#C8102E", "#1D428A",
                             "#ce1141", "#ffc633", "#1D428A", "#552582", "#5D76A9", "#98002e", "#00471b", "#78be20", "#b6995a", "#F58426",
                             "#EF3B24", "#007dc5", "#006bb6", "#e56020", "#000000", "#724c9f", "#bac3c9", "#ce1141", "#002B5C", "#002b5c")) 
```

```{r fr 2019 ht projections, fig.width=11, fig.height=6}
fr_temp_1 <- select_data %>% 
  filter(ld_gleague == "0" | ld_intl == "0") %>%  
  group_by(fr_team) %>% summarize(avg_fppg = mean(ht_fr_fpts, na.rm = TRUE))  
fr_temp_2 <- select_data %>% 
  filter(ld_gleague == "0" | ld_intl == "0") %>% 
  group_by(fr_team) %>% summarize(fr_players = n())
fr_ht_team_projections <- full_join(fr_temp_1, fr_temp_2, by = "fr_team") %>% 
  mutate(team_total = avg_fppg * fr_players) %>% 
  arrange(-team_total); rm(fr_temp_1, fr_temp_2)
fr_ht_team_projections
ggplot(data=fr_ht_team_projections, aes(x=reorder(fr_team, -team_total), y=team_total, fill=fr_team)) +
  geom_bar(stat="identity", width=0.6, colour="black") +
  theme_bw() +
  theme(axis.title.x=element_blank(), axis.title.y=element_blank()) +
  labs(title = "Franchise NBA Rankings (Based on 2019 Hashtag Projections)", fill = "Franchise Team") +
  scale_fill_manual(values=c("#C8102E", "#061922", "#008348", "#00788C", "#ce1141", "#860038", "#007dc5", "#0E2240", "#C8102E", "#1D428A",
                             "#ce1141", "#ffc633", "#1D428A", "#552582", "#5D76A9", "#98002e", "#00471b", "#78be20", "#b6995a", "#F58426",
                             "#EF3B24", "#007dc5", "#006bb6", "#e56020", "#000000", "#724c9f", "#bac3c9", "#ce1141", "#002B5C", "#002b5c")) 
```

```{r looking at specific team's players projections}
select_data %>% 
  filter(fr_team == "CLE") %>% 
  select(player, age, fr_team, bbr_fr_fpts, hta_fr_fpts, ht_fr_fpts, 
         fr_2019, fr_2020, fr_2021, fr_2022, fr_2023, fr_2024, fr_rfa, fr_gleague, fr_intl)
```





















```{r}
colors_tidy <-
  teamcolors::teamcolors %>%
  tidyr::gather(ord, hex, -name, -league)
colors_tidy %>% filter(league == "nba")
```













